<div
  gdAreas="query | results | paginator | reader"
  gdRows="200px 1fr 80px 1fr"
  gdGap="8px"
>
  <!-- query -->
  <form gdArea="query" [formGroup]="form" (submit)="search()">
    <mat-form-field style="width: 100%;">
      <textarea
        rows="3"
        matInput
        [formControl]="query"
        placeholder="query"
      ></textarea>
      <mat-error
        *ngIf="query.errors?.required && (query.dirty || query.touched)"
        >query required</mat-error
      >
      <mat-error
        *ngIf="query.errors?.maxLength && (query.dirty || query.touched)"
        >query too long</mat-error
      >
    </mat-form-field>
    <div>
      <button type="submit" mat-button>
        <mat-icon>search</mat-icon> search
      </button>
    </div>
  </form>

  <!-- results -->
  <div gdArea="results" *ngIf="pagination$ | async as pagination">
    <table>
      <thead>
        <tr>
          <td></td>
          <td></td>
          <td>author</td>
          <td>title</td>
          <td *ngFor="let l of leftContextLabels">{{ l }}</td>
          <td>value</td>
          <td *ngFor="let l of rightContextLabels">{{ l }}</td>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of pagination.data">
          <!-- column: read -->
          <td class="command">
            <button
              mat-icon-button
              type="button"
              matTooltip="Read in context"
              [disabled]="busy"
              color="primary"
              (click)="readDocumentPiece(r.documentId, r.index, r.length)"
            >
              <mat-icon style="color: #ffb764">find_in_page</mat-icon>
            </button>
          </td>
          <!-- column: read-doc -->
          <td class="command">
            <button
              mat-icon-button
              type="button"
              matTooltip="Read document"
              [disabled]="busy"
              (click)="readDocument(r.documentId)"
            >
              <mat-icon style="color: #50cc86">description</mat-icon>
            </button>
          </td>
          <!-- author -->
          <td class="author">{{ r.author }}</td>
          <!-- title -->
          <td class="title">{{ r.title }}</td>
          <!-- left -->
          <td
            class="context"
            *ngFor="let l of leftContextLabels; let i = index"
          >
            {{ r.leftContext[i] }}
          </td>
          <!-- value -->
          <td
            class="value"
            (click)="readDocumentPiece(r.documentId, r.index, r.length)"
          >
            {{ r.value }}
          </td>
          <!-- right -->
          <td
            class="context"
            *ngFor="let l of rightContextLabels; let i = index"
          >
            {{ r.rightContext[i] }}
          </td>
        </tr>
      </tbody>
    </table>

    <!-- pagination -->
    <mat-paginator
      gdArea="pagination"
      gdAlignColumns="center"
      gdAlignRows="start"
      [length]="pagination.total"
      [pageSize]="pageSize?.value"
      [pageSizeOptions]="[20, 50, 75, 100]"
      [pageIndex]="pagination.currentPage - 1"
      [showFirstLastButtons]="true"
      (page)="pageChange($event)"
    ></mat-paginator>
  </div>

  <!-- reader -->
  <div gdArea="reader">
    <pythia-document-reader [request]="readRequest"></pythia-document-reader>
  </div>
</div>
